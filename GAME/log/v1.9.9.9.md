# Changelog v1.9.9.9 - Golden Master Stabilization

**Data:** 23 Novembre 2025
**Versione:** v1.9.9.9 (Golden Master Candidate)

## üéØ Overview
Questa release unifica tutti gli interventi di stabilizzazione, recupero dati e correzione logica effettuati nelle versioni candidate (v1.9.9.83, v1.9.9.84). Rappresenta lo stato definitivo del gioco per la fase Golden Master, garantendo integrit√† dei dati, coerenza narrativa e stabilit√† del sistema.

---

## üõ†Ô∏è Fix Critici & Logica

### üîó Quest & Narrativa
- **Fix Quest "Orologio di Marcus" (`crossroads_investigation`):**
    - Aggiunti i nodi di dialogo mancanti `marcus_investigation_start` e `marcus_investigation_complete` in `dialogues.json`.
    - Corretta la logica per evitare il reset della quest se gi√† attivata dalla bacheca.
    - Ora la quest √® completabile parlando con Marcus.
- **Fix Quest "Il Mulino" (`village_water_mill`):**
    - Rimossa la skill check basata su RNG (Percezione DC 12) per il ritrovamento del Talismano di Jonas. Il ritrovamento √® ora garantito per non bloccare la progressione.
- **Fix Finale Main Quest:**
    - Aggiunto trigger esplicito `special` alla ricompensa finale di `MQ_THE_ECHO_OF_THE_JOURNEY`. Raggiungere le coordinate (145, 146) avvia correttamente la cutscene `CS_POINT_OF_NO_RETURN`.

### üí∞ Sistema di Commercio & Oggetti
- **Fix ID Commerciante:**
    - Rinominato `wandering_trader` in `marcus` in `traders.json` e aggiornati i riferimenti in `encounters.json`. Risolve il crash "Trader not found".
- **Ripristino Database Oggetti (42 Item):**
    - Reintegrati 42 oggetti mancanti (es. `gold_ring`, `weapon_handgun`, `titanic_cassette`) tramite `restored_items.json`.
    - Corrette le propriet√† `stackable` e `value` per garantire un'economia bilanciata e un inventario funzionante.
- **Fix Evento "Titanic":**
    - L'evento `unique_elder_radio_car` ora conferisce correttamente `titanic_cassette` invece di `rare_music_cassettes`, sbloccando la quest di Anya.

### üé® UI/UX & Sistema
- **Miglioramento Feedback:**
    - Aggiunti messaggi di sistema (`SYSTEM_MESSAGE`) nel diario per le azioni di cura (`heal`), migliorando la chiarezza per il giocatore.
- **Handshake Eventi-Dialoghi:**
    - Aggiornato `eventStore.ts` per gestire correttamente l'alias `start_dialogue`, assicurando che gli eventi possano avviare conversazioni (es. Erborista).

---

## üìù Note Tecniche
- **Integrit√† Dati:** Audit completato con successo (`verify-trader-items.js`, `check-json.js`). Nessun errore rilevato.
- **Build:** Compilazione `npm run build` verificata e funzionante.
- **Pulizia:** Unificati i log delle versioni intermedie (v1.9.9.83/84) in questa release master.

---
*Questa versione √® considerata stabile e pronta per la distribuzione finale.*
