# Changelog v1.9.9.91 - Merchant Identity & Logic Fix

**Data:** 23 Novembre 2025
**Versione:** v1.9.9.91 (Golden Master Polish)

## ğŸ¯ Overview
Questa release risolve definitivamente le incongruenze logiche e tecniche del sistema di commercio. L'intervento principale riguarda la separazione delle identitÃ  dei mercanti (Marcus vs Giona) e la correzione dei collegamenti negli eventi, garantendo che ogni interazione commerciale sia coerente con la narrativa e il gameplay.

---

## ğŸ› ï¸ Fix & Miglioramenti

### ğŸ’° Sistema di Commercio (Merchant Identity Split)
- **Separazione IdentitÃ  Mercanti:**
    - **Marcus (Mercante Hub):** Rimane il mercante stanziale dell'Avamposto con il suo inventario completo e scorte di materiali.
    - **Giona (Mercante Errante):** [NUOVO] Introdotta una nuova entitÃ  distinta in `traders.json`.
        - **Inventario:** Curato per riflettere la natura di viaggiatore (Cibo, Acqua, Medkit, Munizioni).
        - **Oggetto Raro:** Aggiunto `rare_component` esclusivo per premiare l'incontro.
- **Fix Evento "Mercante Errante":**
    - Aggiornato `unique_events.json` per puntare correttamente al nuovo ID `giona` invece che a `marcus`.
    - Corretto l'effetto obsoleto `open_trade_screen` in `startTrading`.

### âš™ï¸ Engine & StabilitÃ 
- **Event Store Robustness:**
    - Aggiunto supporto retrocompatibile per l'effetto legacy `open_trade_screen` in `eventStore.ts` per prevenire crash su salvataggi vecchi o eventi non migrati.
- **Global Event Audit:**
    - Eseguita scansione completa di tutti i file JSON degli eventi tramite script dedicato (`verify_events.js`).
    - **Risultato:** 0 errori rilevati su tutti i collegamenti eventi-dialoghi e eventi-trader.

### ğŸ› Bug Fix Minori
- **Dialoghi Mancanti:**
    - Ricreato e reinserito il dialogo mancante di **Olivia (Erborista)** in `dialogues.json`, ripristinando la funzionalitÃ  della sua quest e interazione.

---

## ğŸ“ Note Tecniche
- **Verifica IntegritÃ :** Script `scripts/verify_events.js` aggiunto alla codebase per validazione futura dei link JSON.
- **Stato:** Il sistema di commercio Ã¨ ora logicamente ineccepibile (due entitÃ  separate) e tecnicamente solido.

---
*Versione raccomandata per il rilascio finale.*
